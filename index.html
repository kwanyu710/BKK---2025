<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>12/23-28 æ›¼è°·ä¹‹æ—…</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans TC"', '"Inter"', 'sans-serif'],
                    },
                    colors: {
                        muji: {
                            bg: '#f9f9f7',      /* ç±³ç™½èƒŒæ™¯ */
                            card: '#ffffff',    /* ç´”ç™½å¡ç‰‡ */
                            text: '#4a4a4a',    /* æ·±ç°æ–‡å­— */
                            accent: '#d9730d',  /* æº«æš–æ©˜ (é‡é») */
                            secondary: '#8c9b93', /* é¼ å°¾è‰ç¶  (æ¬¡è¦) */
                            danger: '#ef4444'   /* ç´…è‰²è­¦ç¤º */
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f9f9f7;
            color: #4a4a4a;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 90px; /* Space for bottom nav */
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .page-section { display: none; animation: fadeIn 0.3s ease-in-out; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="antialiased select-none">

    <header class="sticky top-0 z-50 bg-muji-bg/95 backdrop-blur-md px-6 py-4 border-b border-stone-200 shadow-sm">
        <div class="flex justify-between items-center max-w-md mx-auto">
            <div>
                <h1 class="text-xl font-bold tracking-wide text-stone-800">Bangkok Trip</h1>
                <p class="text-xs text-muji-secondary font-medium">12/23(äºŒ) - 12/28(æ—¥)</p>
            </div>
            <div class="text-right">
                <span class="text-xs font-mono bg-stone-200 px-2 py-1 rounded text-stone-600" id="current-time">00:00</span>
            </div>
        </div>
    </header>

    <main class="p-4 max-w-md mx-auto">

        <div id="page-plan" class="page-section active">
            
            <div class="bg-white p-5 rounded-2xl shadow-sm mb-6 border-l-4 border-muji-accent relative overflow-hidden">
                <div class="absolute top-0 right-0 bg-muji-accent text-white text-[10px] px-2 py-1 rounded-bl-lg">å»ç¨‹</div>
                <h3 class="text-sm font-bold text-stone-400 mb-2">Thai AirAsia FD235</h3>
                <div class="flex justify-between items-center">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-stone-800">KHH</div>
                        <div class="text-xs text-stone-500">é«˜é›„ 18:00</div>
                    </div>
                    <div class="text-stone-300 flex flex-col items-center">
                        <i class="fas fa-plane text-muji-accent text-xl"></i>
                        <span class="text-[10px] mt-1 text-stone-400">3h 30m</span>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-stone-800">DMK</div>
                        <div class="text-xs text-stone-500">å»Šæ›¼ 21:30</div>
                    </div>
                </div>
            </div>

            <div class="mb-6 space-y-3">
                <div class="bg-white p-4 rounded-2xl shadow-sm border border-stone-100 relative">
                    <span class="absolute top-3 right-3 text-[10px] bg-stone-100 text-stone-500 px-2 py-0.5 rounded-full">12/23 - 12/25</span>
                    <div class="flex items-start gap-3">
                        <div class="bg-orange-100 w-10 h-10 rounded-full flex items-center justify-center text-orange-500 flex-shrink-0 mt-1">
                            <strong class="text-lg">1</strong>
                        </div>
                        <div>
                            <h4 class="font-bold text-stone-800 text-sm">B2 å”äººè¡—è€€è¯åŠ›å°Šå°šé£¯åº—</h4>
                            <p class="text-xs text-stone-500 mt-1">B2 China Town Yaowarat Premier</p>
                            <a href="https://www.google.com/maps/search/?api=1&query=B2+China+Town+Yaowarat+Premier+Hotel" target="_blank" class="inline-block mt-2 text-xs text-blue-500 hover:underline">
                                <i class="fas fa-map-marker-alt mr-1"></i>å°èˆª (9 Ratchawong Rd)
                            </a>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-2xl shadow-sm border border-stone-100 relative">
                    <span class="absolute top-3 right-3 text-[10px] bg-stone-100 text-stone-500 px-2 py-0.5 rounded-full">12/25 - 12/27</span>
                    <div class="flex items-start gap-3">
                        <div class="bg-green-100 w-10 h-10 rounded-full flex items-center justify-center text-green-600 flex-shrink-0 mt-1">
                            <strong class="text-lg">2</strong>
                        </div>
                        <div>
                            <h4 class="font-bold text-stone-800 text-sm">æ›¼è°·èŒ‰è‰èŠ± 59 è™Ÿé£¯åº—</h4>
                            <p class="text-xs text-stone-500 mt-1">Jasmine 59 Hotel (é€šç¾… BTS)</p>
                            <a href="https://www.google.com/maps/search/?api=1&query=Jasmine+59+Hotel+Bangkok" target="_blank" class="inline-block mt-2 text-xs text-blue-500 hover:underline">
                                <i class="fas fa-map-marker-alt mr-1"></i>å°èˆª (Sukhumvit 59)
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-8 relative pl-4 border-l-2 border-stone-200 ml-2 pb-10">
                
                <div class="relative">
                    <div class="absolute -left-[21px] top-0 bg-stone-800 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm">DAY 1 (äºŒ)</div>
                    <div class="pt-6 space-y-5">
                        <div class="flex flex-col">
                            <span class="text-sm font-bold text-stone-800 mb-1">æŠµé”å»Šæ›¼æ©Ÿå ´ (DMK)</span>
                            <span class="text-xs text-stone-400">21:30 è½åœ°</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-sm font-bold text-stone-800 mb-1">åŒ…è»Šæ¥æ©Ÿ â†’ é£¯åº—</span>
                            <span class="text-xs text-stone-500 bg-stone-100 p-2 rounded">
                                <i class="fas fa-car mr-1"></i>ä¸å¡è»Šç´„ 30 åˆ†é˜<br>
                                é è¨ˆ 22:30 æŠµé” B2 å”äººè¡—é£¯åº—
                            </span>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-sm font-bold text-stone-800 mb-1">å”äººè¡—åƒå®µå¤œ ğŸœ</span>
                            <div class="flex gap-2 mt-1">
                                <a href="https://www.google.com/search?q=2023æ›¼è°·å”äººè¡—å¿…åƒç¾é£Ÿæ‡¶äººåŒ…+è‰¾ç‘çµ²" target="_blank" class="text-xs bg-white border border-stone-200 px-3 py-1.5 rounded-full text-stone-600 shadow-sm">
                                    <i class="fas fa-search mr-1 text-muji-accent"></i>æœç¾é£Ÿæ‡¶äººåŒ…
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="relative">
                    <div class="absolute -left-[21px] top-0 bg-muji-accent text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm">DAY 2 (ä¸‰)</div>
                    <div class="pt-6 space-y-5">
                        <div>
                            <span class="text-sm font-bold text-stone-800 block">â‘  çŸ³é¾è»è·¯ (Charoen Krung)</span>
                            <div class="flex gap-2 mt-2">
                                <a href="https://www.google.com/search?q=çŸ³é¾è»è·¯+ç¾é£Ÿ" target="_blank" class="text-[10px] bg-stone-100 px-2 py-1 rounded text-stone-500">ç¾é£Ÿæ”»ç•¥</a>
                                <a href="https://www.google.com/search?q=çŸ³é¾è»è·¯+æ–‡é’" target="_blank" class="text-[10px] bg-stone-100 px-2 py-1 rounded text-stone-500">æ–‡é’æ•£ç­–</a>
                            </div>
                        </div>
                        <div><span class="text-sm font-bold text-stone-800 block">â‘¡ è‡¥ä½›å¯º (Wat Pho)</span></div>
                        <div><span class="text-sm font-bold text-stone-800 block">â‘¢ é„­ç‹å»Ÿ (Wat Arun)</span></div>
                        <div><span class="text-sm font-bold text-stone-800 block">â‘£ ç‹æœ—å¸‚å ´ (Wang Lang)</span></div>
                        <div class="bg-stone-50 p-3 rounded-lg border border-stone-100">
                            <span class="text-sm font-bold text-muji-accent block">â‘¤ éƒµè¼ªæ™šé¤ ğŸš¢</span>
                            <span class="text-xs text-stone-500">River City Pier å‡ºç™¼</span>
                        </div>
                    </div>
                </div>

                <div class="relative">
                    <div class="absolute -left-[21px] top-0 bg-stone-400 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm">DAY 3 (å››)</div>
                    <div class="pt-6 space-y-5">
                        <div>
                            <span class="text-sm font-bold text-stone-800 block">â‘  æ—©é¤å…©é¸ä¸€</span>
                            <ul class="text-xs text-stone-500 mt-1 ml-4 list-disc">
                                <li>ç›Šç”Ÿç”«è¨˜èŒ¶é¤å»³ (å”äººè¡—è¿‘)</li>
                                <li>å®‰æ¨‚åœ’ (On Lok Yun, èˆŠæ—©é¤)</li>
                            </ul>
                        </div>
                        
                        <div><span class="text-sm font-bold text-stone-800 block">â‘¡ åµ©è¶Šè·¯ (Song Wat Rd)</span></div>
                        
                        <div class="bg-orange-50 p-3 rounded-lg border border-orange-200">
                            <span class="text-xs font-bold text-orange-600 uppercase tracking-wide">Hotel Transfer</span>
                            <p class="text-sm font-bold text-stone-800 mt-1">æ›é£¯åº— âœ Jasmine 59</p>
                            <p class="text-xs text-stone-500">è¨˜å¾—æ”œå¸¶è¡Œæç§»å‹•</p>
                        </div>

                        <div><span class="text-sm font-bold text-stone-800 block">â‘£ çŸ³é¾è»è·¯ä¸ŠåŠæ®µ (ex: 32Bar)</span></div>
                        <div><span class="text-sm font-bold text-stone-800 block">â‘¤ å”äººè¡— / â‘¥ è€ƒå±±è·¯ (é¸)</span></div>
                        <div>
                            <span class="text-sm font-bold text-stone-800 block">â‘¦ ç™¾è²¨å…¬å¸å·¡ç¦®</span>
                            <span class="text-xs text-stone-400 block mt-1">Iconsiam / Central World / Dusit</span>
                        </div>
                    </div>
                </div>

                <div class="relative">
                    <div class="absolute -left-[21px] top-0 bg-muji-accent text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm">DAY 4 (äº”)</div>
                    <div class="pt-6 space-y-5">
                        <div class="bg-red-50 p-3 rounded-xl border border-red-100 shadow-sm flex items-center gap-3">
                            <div class="text-center px-2 border-r border-red-200">
                                <div class="text-lg font-bold text-red-600">08:00</div>
                                <div class="text-[10px] text-red-400">AM</div>
                            </div>
                            <div>
                                <div class="font-bold text-red-800 text-sm">é£¯åº—å¤§å»³é›†åˆ (åŒ…è»Š)</div>
                                <div class="text-xs text-red-500">Jasmine 59 Lobby</div>
                            </div>
                        </div>

                        <div class="pl-2 border-l-2 border-dotted border-stone-300 space-y-4">
                            <div>
                                <span class="text-sm font-bold text-stone-800 block">ğŸ“ ç¾åŠŸéµé“å¸‚å ´</span>
                                <span class="text-xs text-stone-400">çœ‹ç«è»Šç¶“éå¸‚é›†</span>
                            </div>
                            <div>
                                <span class="text-sm font-bold text-stone-800 block">ğŸ“ ä¸¹å«©èæ°´ä¸Šå¸‚å ´</span>
                                <span class="text-xs text-stone-400">æ­æ‰‹æ–èˆ¹é«”é©—</span>
                            </div>
                            <div>
                                <span class="text-sm font-bold text-stone-800 block">ğŸ“ æ¨¹ä¸­å»Ÿ (Wat Bang Kung)</span>
                            </div>
                        </div>

                        <div class="bg-stone-100 p-3 rounded-lg">
                            <span class="text-sm font-bold text-stone-700 block">15:00 - 16:00 å›åˆ°æ›¼è°·</span>
                            <span class="text-xs text-stone-500">å›é£¯åº—ä¼‘æ¯ / æŒ‰æ‘© / é€›ç™¾è²¨</span>
                        </div>
                    </div>
                </div>

                <div class="relative pt-4 text-center pb-8">
                     <div class="inline-block bg-stone-200 text-stone-500 text-[10px] px-3 py-1 rounded-full">å¾ŒçºŒè¡Œç¨‹è‡ªç”±å®‰æ’</div>
                </div>

            </div>
        </div>

        <div id="page-guide" class="page-section">
            <h2 class="text-xl font-bold mb-4">æ™¯é»å°è¦½</h2>
            <div class="space-y-4">
                <div class="bg-white p-4 rounded-xl shadow-sm">
                    <h3 class="font-bold">é„­ç‹å»Ÿ (Wat Arun)</h3>
                    <p class="text-sm text-stone-500 mt-2">å»ºè­°ç©¿è‘—äº®è‰²ç³»æˆ–å‚³çµ±æ³°æœæ‹æ”ï¼ŒèƒŒæ™¯æ˜¯ç™½è‰²ä½›å¡”æœƒéå¸¸æ¼‚äº®ã€‚çˆ¬æ¨“æ¢¯è«‹å°å¿ƒã€‚</p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm">
                    <h3 class="font-bold">ç¾åŠŸéµé“å¸‚å ´</h3>
                    <p class="text-sm text-stone-500 mt-2">ç«è»Šé€²ç«™æ™‚é–“é€šå¸¸ç‚ºï¼š08:30, 11:10, 14:30, 17:40 (æ™‚é–“å¯èƒ½è®Šå‹•ï¼ŒåŒ…è»Šå¸æ©Ÿæœƒæ³¨æ„)ã€‚</p>
                </div>
            </div>
        </div>

        <div id="page-wallet" class="page-section">
            <div class="bg-stone-800 text-white p-5 rounded-2xl shadow-lg mb-6">
                <div class="flex justify-between items-end mb-2">
                    <label class="text-xs text-stone-400">åŒ¯ç‡ (1 THB â‰ˆ <input type="number" id="exchange-rate" value="0.92" class="w-12 bg-transparent border-b border-stone-500 text-center text-white focus:outline-none"> TWD)</label>
                    <button onclick="clearCalc()" class="text-xs text-orange-400 border border-orange-400 px-2 py-1 rounded">AC</button>
                </div>
                <input type="text" id="calc-input" placeholder="0" class="w-full bg-transparent text-right text-3xl font-mono mb-2 focus:outline-none" readonly>
                <div class="text-right border-t border-stone-600 pt-2">
                    <div class="text-xl font-bold text-muji-accent" id="calc-result-thb">à¸¿ 0</div>
                    <div class="text-sm text-stone-400" id="calc-result-twd">NT$ 0</div>
                </div>
                <div class="grid grid-cols-4 gap-3 mt-4">
                    <button onclick="appendCalc('7')" class="btn-calc">7</button>
                    <button onclick="appendCalc('8')" class="btn-calc">8</button>
                    <button onclick="appendCalc('9')" class="btn-calc">9</button>
                    <button onclick="appendCalc('/')" class="btn-calc-op">Ã·</button>
                    <button onclick="appendCalc('4')" class="btn-calc">4</button>
                    <button onclick="appendCalc('5')" class="btn-calc">5</button>
                    <button onclick="appendCalc('6')" class="btn-calc">6</button>
                    <button onclick="appendCalc('*')" class="btn-calc-op">Ã—</button>
                    <button onclick="appendCalc('1')" class="btn-calc">1</button>
                    <button onclick="appendCalc('2')" class="btn-calc">2</button>
                    <button onclick="appendCalc('3')" class="btn-calc">3</button>
                    <button onclick="appendCalc('-')" class="btn-calc-op">-</button>
                    <button onclick="appendCalc('0')" class="btn-calc">0</button>
                    <button onclick="appendCalc('.')" class="btn-calc">.</button>
                    <button onclick="calculate()" class="btn-calc-eq">=</button>
                    <button onclick="appendCalc('+')" class="btn-calc-op">+</button>
                </div>
                <button onclick="addToRecord()" class="w-full mt-4 bg-white/10 py-2 rounded-lg text-sm">åŠ å…¥è¨˜å¸³</button>
            </div>
            
            <div class="bg-white rounded-2xl shadow-sm p-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-stone-700">æ¶ˆè²»ç´€éŒ„</h3>
                    <span class="font-bold text-muji-accent" id="total-expense">à¸¿ 0</span>
                </div>
                <div id="expense-form" class="hidden bg-stone-50 p-3 rounded-lg mb-4">
                    <input type="text" id="expense-name" placeholder="å“é …åç¨±" class="w-full p-2 mb-2 rounded border text-sm">
                    <button onclick="saveExpense()" class="w-full bg-stone-800 text-white rounded p-2 text-sm">ç¢ºèªå„²å­˜</button>
                </div>
                <ul id="expense-list" class="space-y-3"></ul>
            </div>
        </div>

        <div id="page-lists" class="page-section">
            <h2 class="text-xl font-bold mb-4">è¡Œå‰æ¸…å–®</h2>
            <div class="flex gap-2 mb-4">
                <input type="text" id="new-todo" placeholder="æ–°å¢é …ç›®..." class="flex-1 p-3 rounded-xl shadow-sm bg-white">
                <button onclick="addTodo()" class="bg-muji-accent text-white px-4 rounded-xl"><i class="fas fa-plus"></i></button>
            </div>
            <div id="todo-list" class="space-y-2"></div>
        </div>

        <div id="page-info" class="page-section">
            <h2 class="text-xl font-bold mb-4">ç·Šæ€¥è³‡è¨Š</h2>
            <div class="grid grid-cols-2 gap-4 mb-4">
                <a href="tel:1155" class="bg-white p-4 rounded-xl shadow-sm text-center">
                    <i class="fas fa-user-shield text-2xl text-red-500 mb-1"></i>
                    <div class="font-bold text-sm">è§€å…‰è­¦å¯Ÿ 1155</div>
                </a>
                <a href="tel:1669" class="bg-white p-4 rounded-xl shadow-sm text-center">
                    <i class="fas fa-ambulance text-2xl text-red-500 mb-1"></i>
                    <div class="font-bold text-sm">æ•‘è­·è»Š 1669</div>
                </a>
            </div>
            <div class="bg-white p-4 rounded-xl shadow-sm border-l-4 border-blue-500">
                <h3 class="font-bold text-blue-800 mb-1">é§æ³°ä»£è¡¨è™•</h3>
                <a href="tel:+6621193555" class="text-lg font-mono text-blue-600 block mb-1">+66-2-119-3555</a>
                <p class="text-xs text-stone-500">Empire Tower 20F, 1 South Sathorn Rd.</p>
            </div>
        </div>

    </main>

    <nav class="fixed bottom-0 left-0 w-full bg-white border-t border-stone-200 pb-safe pt-2 px-4 z-50 h-[80px]">
        <div class="flex justify-between items-center max-w-md mx-auto">
            <button onclick="navTo('plan')" class="nav-btn active flex flex-col items-center w-1/5 text-stone-800">
                <i class="fas fa-map-marked-alt text-xl mb-1"></i><span class="text-[10px]">è¡Œç¨‹</span>
            </button>
            <button onclick="navTo('guide')" class="nav-btn flex flex-col items-center w-1/5 text-stone-400">
                <i class="fas fa-book-open text-xl mb-1"></i><span class="text-[10px]">å°è¦½</span>
            </button>
            <button onclick="navTo('wallet')" class="nav-btn flex flex-col items-center w-1/5 text-stone-400">
                <div class="bg-muji-accent text-white rounded-full w-12 h-12 flex items-center justify-center -mt-8 shadow-lg border-4 border-muji-bg">
                    <i class="fas fa-wallet text-lg"></i>
                </div>
                <span class="text-[10px] mt-1 font-bold text-muji-accent">è¨˜å¸³</span>
            </button>
            <button onclick="navTo('lists')" class="nav-btn flex flex-col items-center w-1/5 text-stone-400">
                <i class="fas fa-check-square text-xl mb-1"></i><span class="text-[10px]">æ¸…å–®</span>
            </button>
            <button onclick="navTo('info')" class="nav-btn flex flex-col items-center w-1/5 text-stone-400">
                <i class="fas fa-info-circle text-xl mb-1"></i><span class="text-[10px]">è³‡è¨Š</span>
            </button>
        </div>
    </nav>

    <style>
        .btn-calc { @apply p-3 bg-stone-700 rounded-lg shadow active:scale-95 transition; }
        .btn-calc-op { @apply p-3 bg-stone-600 text-orange-300 rounded-lg shadow active:scale-95 transition; }
        .btn-calc-eq { @apply p-3 bg-muji-accent text-white rounded-lg shadow active:scale-95 transition row-span-2; }
    </style>

    <script>
        // --- Navigation ---
        function navTo(pageId) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('text-stone-800');
                el.classList.add('text-stone-400');
            });
            // Simple highlight logic
            const map = { 'plan':0, 'guide':1, 'wallet':2, 'lists':3, 'info':4 };
            document.querySelectorAll('.nav-btn')[map[pageId]].classList.remove('text-stone-400');
            document.querySelectorAll('.nav-btn')[map[pageId]].classList.add('text-stone-800');
            window.scrollTo(0, 0);
        }

        // --- Clock ---
        setInterval(() => {
            document.getElementById('current-time').innerText = new Date().toLocaleTimeString('en-US', {hour:'2-digit', minute:'2-digit', hour12:false});
        }, 1000);

        // --- Wallet ---
        let calcExp = "";
        let expenses = JSON.parse(localStorage.getItem('bkk_expenses') || "[]");

        function renderExpenses() {
            const list = document.getElementById('expense-list');
            const totalEl = document.getElementById('total-expense');
            list.innerHTML = "";
            let total = 0;
            if(expenses.length === 0) list.innerHTML = '<li class="text-center text-stone-400 text-xs">å°šç„¡ç´€éŒ„</li>';
            
            expenses.slice().reverse().forEach((item, idx) => {
                total += parseFloat(item.amount);
                const li = document.createElement('li');
                li.className = "flex justify-between items-center bg-stone-50 p-2 rounded border border-stone-100";
                li.innerHTML = `
                    <div>
                        <div class="font-bold text-sm text-stone-700">${item.name}</div>
                        <div class="text-[10px] text-stone-400">${item.date}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-stone-800">à¸¿ ${item.amount}</div>
                        <button onclick="delExpense(${expenses.length - 1 - idx})" class="text-[10px] text-red-300">åˆªé™¤</button>
                    </div>
                `;
                list.appendChild(li);
            });
            totalEl.innerText = `à¸¿ ${total}`;
        }

        function appendCalc(v) { calcExp += v; document.getElementById('calc-input').value = calcExp; }
        function clearCalc() { calcExp = ""; document.getElementById('calc-input').value = ""; document.getElementById('calc-result-thb').innerText="à¸¿ 0"; document.getElementById('calc-result-twd').innerText="NT$ 0"; }
        function calculate() {
            try {
                const res = eval(calcExp); // Simple eval for calculator
                document.getElementById('calc-result-thb').innerText = `à¸¿ ${res}`;
                document.getElementById('calc-result-twd').innerText = `NT$ ${Math.round(res * document.getElementById('exchange-rate').value)}`;
                document.getElementById('calc-input').setAttribute('data-res', res);
            } catch(e) {}
        }
        function addToRecord() {
            const val = document.getElementById('calc-input').getAttribute('data-res');
            if(!val) return alert('è«‹å…ˆè¨ˆç®—é‡‘é¡');
            document.getElementById('expense-form').classList.remove('hidden');
            document.getElementById('expense-form').setAttribute('data-amt', val);
        }
        function saveExpense() {
            const amt = document.getElementById('expense-form').getAttribute('data-amt');
            const name = document.getElementById('expense-name').value || "æ¶ˆè²»";
            expenses.push({ name, amount: amt, date: new Date().toLocaleDateString() });
            localStorage.setItem('bkk_expenses', JSON.stringify(expenses));
            document.getElementById('expense-form').classList.add('hidden');
            document.getElementById('expense-name').value = "";
            clearCalc();
            renderExpenses();
        }
        function delExpense(idx) {
            if(confirm("åˆªé™¤æ­¤ç­†?")) {
                expenses.splice(idx, 1);
                localStorage.setItem('bkk_expenses', JSON.stringify(expenses));
                renderExpenses();
            }
        }

        // --- Lists ---
        let todos = JSON.parse(localStorage.getItem('bkk_todos') || '[{"text":"è­·ç…§","done":false},{"text":"eSIM / ç¶²å¡","done":false},{"text":"æ—…éŠä¿éšª","done":false}]');
        function renderTodos() {
            const list = document.getElementById('todo-list');
            list.innerHTML = "";
            todos.forEach((t, i) => {
                const div = document.createElement('div');
                div.className = "flex items-center bg-white p-3 rounded-xl shadow-sm";
                div.innerHTML = `
                    <input type="checkbox" ${t.done?'checked':''} onchange="toggleTodo(${i})" class="w-5 h-5 accent-orange-500">
                    <span class="ml-3 flex-1 text-sm ${t.done?'line-through text-stone-300':'text-stone-700'}">${t.text}</span>
                    <button onclick="removeTodo(${i})" class="text-stone-300"><i class="fas fa-times"></i></button>
                `;
                list.appendChild(div);
            });
        }
        function addTodo() {
            const val = document.getElementById('new-todo').value;
            if(!val) return;
            todos.push({text: val, done: false});
            localStorage.setItem('bkk_todos', JSON.stringify(todos));
            document.getElementById('new-todo').value = "";
            renderTodos();
        }
        function toggleTodo(i) { todos[i].done = !todos[i].done; localStorage.setItem('bkk_todos', JSON.stringify(todos)); renderTodos(); }
        function removeTodo(i) { todos.splice(i, 1); localStorage.setItem('bkk_todos', JSON.stringify(todos)); renderTodos(); }

        // Init
        window.onload = function() {
            renderExpenses();
            renderTodos();
        }
    </script>
</body>
</html>
